# DinoOverlay CDN Security Configuration
# Generated on 2025-09-04T20:11:28.031Z

server {
    listen 443 ssl http2;
    server_name cdn.dinooverlay.com backup-cdn.dinooverlay.com;
    
    # SSL configuration
    ssl_certificate /path/to/certificate.crt;
    ssl_certificate_key /path/to/private.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;
    
    # Security headers
    add_header "Content-Security-Policy" "script-src 'self' https://cdn.dinooverlay.com https://backup-cdn.dinooverlay.com 'sha384-pQDnBTnbChB3fgJXCARgfoDNzDwCONpvqK4CGDIXFaaKBieD6PHr1u9loIFBWKjl sha384-badg/rnYoXzABqabanZK6jAmk5W5ur6718ZERBWPIcuKMywg6T1WggrO5Fz2BbVu sha384-070IklUck0YB2zvNbvQGH4Hdgx9mxcylnaoMqBpt7eZOYyRIiFK50Ddn2TD/6K4t'; connect-src 'self' https://api.dinooverlay.com; img-src 'self' data: https://api.dinooverlay.com; style-src 'self' 'unsafe-inline'" always;
    add_header "X-Content-Type-Options" "nosniff" always;
    add_header "X-Frame-Options" "DENY" always;
    add_header "X-XSS-Protection" "1; mode=block" always;
    add_header "Referrer-Policy" "strict-origin-when-cross-origin" always;
    add_header "Permissions-Policy" "camera=(), microphone=(), geolocation=()" always;
    add_header "Strict-Transport-Security" "max-age=31536000; includeSubDomains; preload" always;
    
    # CORS headers
    add_header "Access-Control-Allow-Origin" "*" always;
    add_header "Access-Control-Allow-Methods" "GET, OPTIONS" always;
    add_header "Access-Control-Allow-Headers" "Content-Type" always;
    
    # Cache control
    location ~* \.(js|css)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    location ~* \.(json)$ {
        expires 1h;
        add_header Cache-Control "public";
    }
    
    # Compression
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/javascript
        application/xml+rss
        application/json;
    
    # Security restrictions
    location ~ /\. {
        deny all;
    }
    
    location ~* \.(json)$ {
        location ~ ^/(integrity-manifest|cdn-config)\.json$ {
            # Allow access to specific JSON files
        }
        deny all;
    }
}